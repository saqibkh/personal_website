<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khan Saqib | Professional Calculator</title>
    <meta name="description" content="Scientific & Programmer Web Calculator.">
    
    <link rel="stylesheet" href="../../../../../static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        /* --- CALCULATOR CONTAINER --- */
        .calc-wrapper {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding-top: 2rem;
        }

        .calc-container {
            width: 100%;
            max-width: 450px; /* Standard width */
            background: #202020;
            border-radius: 12px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            overflow: hidden;
            border: 1px solid #333;
            transition: max-width 0.3s ease;
        }
        
        /* Wider container for Scientific/Programmer modes */
        .calc-container.wide-mode {
            max-width: 650px;
        }

        /* --- SCREEN --- */
        .calc-screen {
            background: #0a0a0a;
            color: #fff;
            padding: 2rem;
            text-align: right;
            border-bottom: 1px solid #333;
            position: relative;
        }
        .calc-history {
            font-size: 0.9rem;
            color: #888;
            min-height: 1.5em;
            margin-bottom: 0.2rem;
            font-family: monospace;
        }
        .calc-output {
            font-size: 3rem;
            font-weight: 300;
            word-break: break-all;
            font-family: 'Inter', sans-serif;
        }

        /* --- MODE TABS --- */
        .mode-tabs {
            display: flex;
            background: #151515;
            border-bottom: 1px solid #333;
        }
        .mode-tab {
            flex: 1;
            padding: 1rem;
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
            transition: 0.2s;
        }
        .mode-tab:hover { color: #fff; background: #252525; }
        .mode-tab.active {
            color: var(--accent);
            background: #202020;
            border-bottom: 2px solid var(--accent);
        }

        /* --- PROGRAMMER BASE SWITCHER --- */
        .base-switch-container {
            display: none; /* Hidden by default */
            background: #1a1a1a;
            padding: 10px 20px;
            border-bottom: 1px solid #333;
        }
        .base-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 0;
            cursor: pointer;
            color: #666;
            font-family: monospace;
            font-size: 0.9rem;
            border-radius: 4px;
        }
        .base-row:hover { background: #252525; }
        .base-row.active { color: var(--accent); font-weight: bold; }
        .base-label { font-weight: 700; width: 40px; }
        .base-val { text-align: right; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }

        /* --- KEYPAD GRID --- */
        .keypad {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1px;
            background: #333;
        }
        
        /* Scientific Layout: 5 Columns */
        .keypad.scientific-grid {
            grid-template-columns: repeat(5, 1fr);
        }

        /* Programmer Layout: 5 Columns (Hex keys on left) */
        .keypad.programmer-grid {
            grid-template-columns: repeat(5, 1fr);
        }

        /* BUTTON STYLES */
        .btn-calc {
            background: #202020;
            border: none;
            height: 65px;
            font-size: 1.1rem;
            color: #fff;
            cursor: pointer;
            transition: 0.1s;
            user-select: none;
        }
        .btn-calc:active, .btn-calc.pressed { background: #353535; }
        .btn-calc:hover { background: #2a2a2a; }
        
        /* Disabled button state (for Programmer mode) */
        .btn-calc:disabled {
            opacity: 0.2;
            cursor: not-allowed;
        }

        .btn-op { color: var(--accent); font-weight: 600; background: #1a1a1a; }
        .btn-eq { background: var(--accent); color: #000; font-weight: 700; }
        .btn-eq:hover { background: #5a95f5; opacity: 0.9; }
        .btn-clear { color: #ff5555; background: #181010; }

        /* Scientific Keys Styling */
        .btn-sci { 
            font-size: 0.9rem; 
            color: #aaa; 
            background: #181818;
            border-top: 2px solid transparent; 
        }
        .btn-sci:hover { color: #fff; border-top: 2px solid var(--accent); }

        /* Hex Keys Styling */
        .btn-hex { 
            color: #dcb1ff; 
            font-weight: 600; 
            background: #181818; 
        }

        /* Visibility Helpers */
        .sci-key, .prog-key { display: none; }
        .sci-key.visible, .prog-key.visible { display: block; }

    </style>
</head>
<body>

    <nav class="navbar">
        <div class="logo">KHAN SAQIB.</div>
        <ul class="nav-links">
            <li><a href="/">About</a></li>
            <li><a href="/projects">Projects</a></li>
            <li><a href="/apps">Apps</a></li>
            <li><a href="/#contact" class="btn-primary">Contact</a></li>
        </ul>
    </nav>

    <section class="projects-section">
        <div class="container" style="padding-top: 80px;">
            
            <div class="calc-wrapper">
                <div class="calc-container" id="calcContainer">
                    
                    <div class="mode-tabs">
                        <button class="mode-tab active" onclick="setMode('standard')">Standard</button>
                        <button class="mode-tab" onclick="setMode('scientific')">Scientific</button>
                        <button class="mode-tab" onclick="setMode('programmer')">Programmer</button>
                    </div>

                    <div class="calc-screen">
                        <div class="calc-history" id="history"></div>
                        <div class="calc-output" id="display">0</div>
                    </div>

                    <div class="base-switch-container" id="baseSwitcher">
                        <div class="base-row" id="rowHex" onclick="setBase(16)">
                            <span class="base-label">HEX</span>
                            <span class="base-val" id="valHex">0</span>
                        </div>
                        <div class="base-row active" id="rowDec" onclick="setBase(10)">
                            <span class="base-label">DEC</span>
                            <span class="base-val" id="valDec">0</span>
                        </div>
                        <div class="base-row" id="rowOct" onclick="setBase(8)">
                            <span class="base-label">OCT</span>
                            <span class="base-val" id="valOct">0</span>
                        </div>
                        <div class="base-row" id="rowBin" onclick="setBase(2)">
                            <span class="base-label">BIN</span>
                            <span class="base-val" id="valBin">0</span>
                        </div>
                    </div>

                    <div class="keypad" id="keypad">
                        
                        <button class="btn-calc btn-sci sci-key" onclick="handleMath('sin')">sin</button>
                        <button class="btn-calc btn-sci sci-key" onclick="handleMath('cos')">cos</button>
                        <button class="btn-calc btn-sci sci-key" onclick="handleMath('tan')">tan</button>
                        
                        <button class="btn-calc btn-hex prog-key" data-key="A" onclick="insert('A')">A</button>
                        <button class="btn-calc btn-hex prog-key" data-key="B" onclick="insert('B')">B</button>
                        
                        <button class="btn-calc btn-clear" data-key="Escape" onclick="clearDisplay()">AC</button>
                        <button class="btn-calc btn-clear" data-key="Backspace" onclick="deleteChar()">⌫</button>
                        <button class="btn-calc btn-op" data-key="%" onclick="insert('%')">%</button>
                        <button class="btn-calc btn-op" data-key="/" onclick="insert('/')">÷</button>

                        <button class="btn-calc btn-sci sci-key" onclick="handleMath('asin')">sin⁻¹</button>
                        <button class="btn-calc btn-sci sci-key" onclick="handleMath('acos')">cos⁻¹</button>
                        <button class="btn-calc btn-sci sci-key" onclick="handleMath('atan')">tan⁻¹</button>
                        
                        <button class="btn-calc btn-hex prog-key" data-key="C" onclick="insert('C')">C</button>
                        <button class="btn-calc btn-hex prog-key" data-key="D" onclick="insert('D')">D</button>

                        <button class="btn-calc num-key" data-key="7" onclick="insert('7')">7</button>
                        <button class="btn-calc num-key" data-key="8" onclick="insert('8')">8</button>
                        <button class="btn-calc num-key" data-key="9" onclick="insert('9')">9</button>
                        <button class="btn-calc btn-op" data-key="*" onclick="insert('*')">×</button>

                        <button class="btn-calc btn-sci sci-key" onclick="handleMath('ln')">ln</button>
                        <button class="btn-calc btn-sci sci-key" onclick="handleMath('log')">log</button>
                        <button class="btn-calc btn-sci sci-key" onclick="handleMath('sqrt')">√</button>

                        <button class="btn-calc btn-hex prog-key" data-key="E" onclick="insert('E')">E</button>
                        <button class="btn-calc btn-hex prog-key" data-key="F" onclick="insert('F')">F</button>

                        <button class="btn-calc num-key" data-key="4" onclick="insert('4')">4</button>
                        <button class="btn-calc num-key" data-key="5" onclick="insert('5')">5</button>
                        <button class="btn-calc num-key" data-key="6" onclick="insert('6')">6</button>
                        <button class="btn-calc btn-op" data-key="-" onclick="insert('-')">−</button>

                        <button class="btn-calc btn-sci sci-key" onclick="handleMath('pow')">x^y</button>
                        <button class="btn-calc btn-sci sci-key" onclick="handleMath('pi')">π</button>
                        <button class="btn-calc btn-sci sci-key" onclick="handleMath('e')">e</button>
                        
                        <button class="btn-calc btn-hex prog-key" onclick="insert('(')">(</button>
                        <button class="btn-calc btn-hex prog-key" onclick="insert(')')">)</button>

                        <button class="btn-calc num-key" data-key="1" onclick="insert('1')">1</button>
                        <button class="btn-calc num-key" data-key="2" onclick="insert('2')">2</button>
                        <button class="btn-calc num-key" data-key="3" onclick="insert('3')">3</button>
                        <button class="btn-calc btn-op" data-key="+" onclick="insert('+')">+</button>

                        <button class="btn-calc btn-sci sci-key" onclick="insert('(')">(</button>
                        <button class="btn-calc btn-sci sci-key" onclick="insert(')')">)</button>
                        <button class="btn-calc btn-sci sci-key" onclick="handleMath('abs')">|x|</button>

                        <button class="btn-calc btn-hex prog-key" disabled>N/A</button>
                        <button class="btn-calc btn-hex prog-key" disabled>N/A</button>

                        <button class="btn-calc num-key" style="border-bottom-left-radius: 12px;" onclick="toggleSign()">±</button>
                        <button class="btn-calc num-key" data-key="0" onclick="insert('0')">0</button>
                        <button class="btn-calc num-key" data-key="." id="btnDot" onclick="insert('.')">.</button>
                        <button class="btn-calc btn-eq" style="border-bottom-right-radius: 12px;" data-key="Enter" onclick="calculate()">=</button>
                    </div>

                </div>
            </div>

        </div>
    </section>

    <footer id="contact">
        <div class="container">
            <h2>Let's build something together.</h2>
            <p>Open for opportunities in software development and technical consulting.</p>
            <a href="mailto:saqibkhan@utexas.edu" class="email-link">saqibkhan@utexas.edu</a>
            <div class="copyright">
                &copy; 2026 Khan Saqib. All rights reserved.
            </div>
        </div>
    </footer>

    <script>
        const display = document.getElementById('display');
        const history = document.getElementById('history');
        const keypad = document.getElementById('keypad');
        const container = document.getElementById('calcContainer');
        const baseSwitcher = document.getElementById('baseSwitcher');

        let currentMode = 'standard';
        let currentBase = 10;
        let currentValue = 0; // Stores actual integer value for Programmer mode

        // --- KEYBOARD LISTENER ---
        document.addEventListener('keydown', (e) => {
            const key = e.key;
            
            // Map special keys
            if (key === 'Enter') { e.preventDefault(); calculate(); return; }
            if (key === 'Escape') { clearDisplay(); return; }
            if (key === 'Backspace') { deleteChar(); return; }
            
            // Find button with matching data-key attribute for visual effect
            const btn = document.querySelector(`button[data-key="${key}"]`);
            if (btn && !btn.disabled) {
                btn.click();
                btn.classList.add('pressed');
                setTimeout(() => btn.classList.remove('pressed'), 100);
            }
        });

        // --- CORE FUNCTIONS ---
        function insert(char) {
            // Validation for Programmer Mode limits
            if (currentMode === 'programmer') {
                if (currentBase === 2 && !['0','1'].includes(char)) return;
                if (currentBase === 8 && !['0','1','2','3','4','5','6','7'].includes(char)) return;
                if (currentBase === 10 && !/[0-9]/.test(char)) return;
            }

            if (display.innerText === '0' && char !== '.' && !['+','-','*','/'].includes(char)) {
                display.innerText = char;
            } else {
                display.innerText += char;
            }

            if (currentMode === 'programmer') updateBaseViews();
        }

        function clearDisplay() {
            display.innerText = '0';
            history.innerText = '';
            currentValue = 0;
            if (currentMode === 'programmer') updateBaseViews();
        }

        function deleteChar() {
            if (display.innerText.length > 1) {
                display.innerText = display.innerText.slice(0, -1);
            } else {
                display.innerText = '0';
            }
            if (currentMode === 'programmer') updateBaseViews();
        }

        function toggleSign() {
            if (display.innerText.startsWith('-')) {
                display.innerText = display.innerText.slice(1);
            } else if (display.innerText !== '0') {
                display.innerText = '-' + display.innerText;
            }
            if (currentMode === 'programmer') updateBaseViews();
        }

        function calculate() {
            try {
                let expression = display.innerText;
                
                if (currentMode === 'programmer') {
                    // In programmer mode, we just ensure the current input is saved
                    // Calculations (like + -) in Prog mode are complex to implement strictly
                    // So we treat 'Equals' as a "Commit" action.
                    updateBaseViews();
                    return;
                }

                // Standard/Sci Calculation
                history.innerText = expression + ' =';
                expression = expression.replace('×', '*').replace('÷', '/');
                expression = expression.replace(/\^/g, '**'); 
                
                // Safe evaluation
                let result = eval(expression);
                
                // Format decimal length
                if (!Number.isInteger(result)) {
                    result = parseFloat(result.toFixed(8));
                }
                
                display.innerText = result;

            } catch (error) {
                display.innerText = 'Error';
                setTimeout(clearDisplay, 1500);
            }
        }

        function handleMath(func) {
            let val = parseFloat(display.innerText);
            let res = 0;
            switch(func) {
                case 'sin': res = Math.sin(val); break;
                case 'cos': res = Math.cos(val); break;
                case 'tan': res = Math.tan(val); break;
                case 'asin': res = Math.asin(val); break;
                case 'acos': res = Math.acos(val); break;
                case 'atan': res = Math.atan(val); break;
                case 'ln': res = Math.log(val); break;
                case 'log': res = Math.log10(val); break;
                case 'sqrt': res = Math.sqrt(val); break;
                case 'abs': res = Math.abs(val); break;
                case 'pi': insert(Math.PI.toFixed(8)); return;
                case 'e': insert(Math.E.toFixed(8)); return;
                case 'pow': insert('^'); return;
            }
            display.innerText = parseFloat(res.toFixed(8));
        }

        // --- PROGRAMMER MODE LOGIC ---
        function setBase(base) {
            // 1. Convert current display value to Decimal integer first
            let currentStr = display.innerText;
            let val = parseInt(currentStr, currentBase); // Parse from OLD base
            
            if (isNaN(val)) val = 0;

            // 2. Set new base
            currentBase = base;
            
            // 3. Update Display to new base
            display.innerText = val.toString(currentBase).toUpperCase();

            // 4. Update UI (Active Row)
            document.querySelectorAll('.base-row').forEach(row => row.classList.remove('active'));
            if(base === 16) document.getElementById('rowHex').classList.add('active');
            if(base === 10) document.getElementById('rowDec').classList.add('active');
            if(base === 8) document.getElementById('rowOct').classList.add('active');
            if(base === 2) document.getElementById('rowBin').classList.add('active');

            updateKeypadState();
        }

        function updateBaseViews() {
            // Get current value based on active base
            let val = parseInt(display.innerText, currentBase);
            if (isNaN(val)) val = 0;

            document.getElementById('valHex').innerText = val.toString(16).toUpperCase();
            document.getElementById('valDec').innerText = val.toString(10);
            document.getElementById('valOct').innerText = val.toString(8);
            document.getElementById('valBin').innerText = val.toString(2);
        }

        function updateKeypadState() {
            // Enable/Disable keys based on base
            const buttons = document.querySelectorAll('button[data-key]');
            const hexKeys = ['A','B','C','D','E','F'];
            const nums = ['0','1','2','3','4','5','6','7','8','9'];

            buttons.forEach(btn => {
                const key = btn.getAttribute('data-key');
                let enabled = true;

                if (currentBase === 2) { // Binary: Only 0, 1 allowed
                    if (nums.includes(key) && key > 1) enabled = false;
                    if (hexKeys.includes(key)) enabled = false;
                } 
                else if (currentBase === 8) { // Octal: 0-7 allowed
                    if (nums.includes(key) && key > 7) enabled = false;
                    if (hexKeys.includes(key)) enabled = false;
                }
                else if (currentBase === 10) { // Decimal: 0-9 allowed
                    if (hexKeys.includes(key)) enabled = false;
                }
                // Hex: All allowed

                btn.disabled = !enabled;
                if (!enabled) btn.style.opacity = '0.2';
                else btn.style.opacity = '1';
            });
            
            // Decimal point is usually disabled in programmer integers
            document.getElementById('btnDot').disabled = true;
            document.getElementById('btnDot').style.opacity = '0.2';
        }

        // --- MODE SWITCHING ---
        function setMode(mode) {
            currentMode = mode;
            currentBase = 10; // Reset to decimal when switching modes
            clearDisplay();

            // 1. Reset Tabs
            document.querySelectorAll('.mode-tab').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');

            // 2. Reset Layout Classes
            keypad.className = 'keypad'; // Reset grid
            container.className = 'calc-container';
            baseSwitcher.style.display = 'none';
            document.getElementById('btnDot').disabled = false;
            document.getElementById('btnDot').style.opacity = '1';

            // 3. Hide all special keys first
            document.querySelectorAll('.sci-key, .prog-key').forEach(k => k.classList.remove('visible'));

            // 4. Apply Specific Mode Settings
            if (mode === 'scientific') {
                container.classList.add('wide-mode');
                keypad.classList.add('scientific-grid');
                document.querySelectorAll('.sci-key').forEach(k => k.classList.add('visible'));
            } 
            else if (mode === 'programmer') {
                container.classList.add('wide-mode');
                keypad.classList.add('programmer-grid');
                baseSwitcher.style.display = 'block';
                document.querySelectorAll('.prog-key').forEach(k => k.classList.add('visible'));
                setBase(10); // Initialize programmer logic
            }
        }
    </script>

</body>
</html>
